# DEEPLY

This repository contains the reproduction package for the DEEPLY paper.

## Instructions to run

* Install dependencies: `pip3 install requirements.txt`.
* Add the weights you want to use on L27 of `deeply/deeply.py`. If the weights are unknown, set it to an empty dictionary. Line 27 has several examples of this with known weights. For unknown weights, this would simply be:
```{py}
'application': {}
```
* Run the code: `cd deeply && python3 deeply.py`.

## Output

The output will be on the terminal. You can redirect it as desired. For example, in an unsupervised VM such as Google Cloud, you might use

```{sh}
nohup python3 deeply.py > output.txt 2>&1 &
```

Currently, the program outputs a tab-separated output. You could set it to other formats in L206. Examples are CSV (`tablefmt='csv'`), GitHub-flavored Markdown tables (`tablefmt='github'`).

# Reproducing the research questions

For RQ1 ("How prevalent is hyper-parameter brittleness") and RQ2 ("Is hyper-parameter optimization enough to curb optimizer brittleness") we simply run each of the prior works 30 times and run a Scott-Knott test. For RQ2, we have included `RQ2.py` in the root of this repository, which will reproduce Fig. 1 from the paper.

For Scott-Knott results, please refer to `RQ1.py`.

## RQ3: How else might we fix the brittleness problem?

`RQ3.sh` runs the DEEPLY code in this repository. The weights, which are in `deeply/deeply.py`, are gathered from a Monte Carlo simulation. You can obtain the correlations by changing lines 75-85 in this file, running the code for 1000 iterations instead of 100, and then plotting correlations.

## RQ4: Does DEEPLY generate dust or boulders?

We answered this question using Fig. 3 in the paper. To generate that, we ran our DEEPLY code, also printing out the partition sizes. That was generated by the code in `RQ4.py`.

## RQ5: How useful is the loss function?

This question, which relies on a Scott-Knott test, is also done in `RQ1.py`. In that file, `us-loss` is the results without the loss function. That code was used to generate Table 5.